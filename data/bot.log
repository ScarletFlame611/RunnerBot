2025-01-09 23:38:19,732 - __main__ - INFO - Запуск main()
2025-01-09 23:38:19,734 - __main__ - INFO - Инициализация базы данных
2025-01-09 23:38:19,790 - __main__ - INFO - Настройка бота и диспетчера
2025-01-09 23:38:19,816 - __main__ - INFO - Подключение middleware
2025-01-09 23:38:19,816 - __main__ - INFO - Регистрация хендлеров
2025-01-09 23:38:19,816 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-09 23:38:19,817 - aiogram.dispatcher - INFO - Start polling
2025-01-09 23:38:20,785 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-09 23:38:39,643 - bot.handlers.start - INFO - Пользователь 615014924 вызвал команду /start
2025-01-09 23:38:39,644 - bot.handlers.start - INFO - Пользователь 615014924 уже зарегистрирован
2025-01-09 23:38:47,821 - aiogram.event - INFO - Update id=785581694 is handled. Duration 8172 ms by bot id=7987337779
2025-01-09 23:39:03,979 - aiogram.event - INFO - Update id=785581695 is handled. Duration 280 ms by bot id=7987337779
2025-01-09 23:39:06,134 - bot.handlers.start - INFO - Пользователь 615014924 вызвал команду /start
2025-01-09 23:39:06,134 - bot.handlers.start - INFO - Пользователь 615014924 уже зарегистрирован
2025-01-09 23:39:07,433 - aiogram.event - INFO - Update id=785581696 is handled. Duration 1312 ms by bot id=7987337779
2025-01-09 23:39:37,067 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-09 23:39:37,067 - aiogram.dispatcher - INFO - Polling stopped
2025-01-09 23:39:37,322 - __main__ - INFO - Закрытие сессии бота
2025-01-09 23:43:49,405 - __main__ - INFO - Запуск main()
2025-01-09 23:43:49,406 - __main__ - INFO - Инициализация базы данных
2025-01-09 23:43:49,407 - __main__ - INFO - Настройка бота и диспетчера
2025-01-09 23:43:49,424 - __main__ - INFO - Подключение middleware
2025-01-09 23:43:49,424 - __main__ - INFO - Регистрация хендлеров
2025-01-09 23:43:49,425 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-09 23:43:49,425 - aiogram.dispatcher - INFO - Start polling
2025-01-09 23:43:50,209 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-09 23:43:59,753 - bot.handlers.start - INFO - Пользователь 615014924 вызвал команду /start
2025-01-09 23:43:59,754 - bot.handlers.start - INFO - Пользователь 615014924 уже зарегистрирован
2025-01-09 23:44:00,249 - aiogram.event - INFO - Update id=785581697 is handled. Duration 500 ms by bot id=7987337779
2025-01-09 23:44:03,698 - aiogram.event - INFO - Update id=785581698 is handled. Duration 452 ms by bot id=7987337779
2025-01-09 23:44:07,383 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-09 23:44:07,384 - aiogram.dispatcher - INFO - Polling stopped
2025-01-09 23:44:07,646 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:12:09,533 - __main__ - INFO - Запуск main()
2025-01-12 01:12:09,570 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:12:09,589 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:12:09,644 - __main__ - INFO - Подключение middleware
2025-01-12 01:12:09,644 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:12:09,644 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:12:09,644 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:12:11,036 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:12:14,139 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:12:14,139 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:12:14,399 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:12:39,454 - __main__ - INFO - Запуск main()
2025-01-12 01:12:39,455 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:12:39,456 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:12:39,466 - __main__ - INFO - Подключение middleware
2025-01-12 01:12:39,466 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:12:39,467 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:12:39,467 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:12:40,263 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:12:50,607 - aiogram.event - INFO - Update id=785581700 is handled. Duration 983 ms by bot id=7987337779
2025-01-12 01:12:57,111 - aiogram.event - INFO - Update id=785581701 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:13:14,942 - aiogram.event - INFO - Update id=785581702 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:15:42,351 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:15:42,351 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:15:42,607 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:15:49,036 - __main__ - INFO - Запуск main()
2025-01-12 01:15:49,037 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:15:49,050 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:15:49,071 - __main__ - INFO - Подключение middleware
2025-01-12 01:15:49,071 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:15:49,071 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:15:49,071 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:15:50,794 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:15:54,821 - aiogram.event - INFO - Update id=785581703 is handled. Duration 1172 ms by bot id=7987337779
2025-01-12 01:15:59,141 - aiogram.event - INFO - Update id=785581704 is handled. Duration 593 ms by bot id=7987337779
2025-01-12 01:16:04,453 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:16:04,453 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:16:04,710 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:17:33,666 - __main__ - INFO - Запуск main()
2025-01-12 01:17:33,667 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:17:33,668 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:17:33,679 - __main__ - INFO - Подключение middleware
2025-01-12 01:17:33,679 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:17:33,679 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:17:33,679 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:17:35,132 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:17:52,333 - aiogram.event - INFO - Update id=785581705 is handled. Duration 827 ms by bot id=7987337779
2025-01-12 01:17:53,664 - aiogram.event - INFO - Update id=785581706 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:17:53,664 - aiogram.event - ERROR - Cause exception while process update id=785581706 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 39, in profile_button_pressed
    await menu_command(fake_message)
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 22, in menu_command
    await message.answer(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 89, in __await__
    raise RuntimeError(
RuntimeError: This method is not mounted to a any bot instance, please call it explicilty with bot instance `await bot(method)`
or mount method to a bot instance `method.as_(bot)` and then call it `await method`

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 01:18:01,663 - aiogram.event - INFO - Update id=785581707 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:18:01,663 - aiogram.event - ERROR - Cause exception while process update id=785581707 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 39, in profile_button_pressed
    await menu_command(fake_message)
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 22, in menu_command
    await message.answer(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 89, in __await__
    raise RuntimeError(
RuntimeError: This method is not mounted to a any bot instance, please call it explicilty with bot instance `await bot(method)`
or mount method to a bot instance `method.as_(bot)` and then call it `await method`

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 01:18:04,960 - aiogram.event - INFO - Update id=785581708 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:18:04,960 - aiogram.event - ERROR - Cause exception while process update id=785581708 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 39, in profile_button_pressed
    await menu_command(fake_message)
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 22, in menu_command
    await message.answer(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 89, in __await__
    raise RuntimeError(
RuntimeError: This method is not mounted to a any bot instance, please call it explicilty with bot instance `await bot(method)`
or mount method to a bot instance `method.as_(bot)` and then call it `await method`

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 01:18:08,711 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:18:08,711 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:18:08,973 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:20:48,868 - __main__ - INFO - Запуск main()
2025-01-12 01:20:48,869 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:20:48,870 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:20:48,881 - __main__ - INFO - Подключение middleware
2025-01-12 01:20:48,881 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:20:48,881 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:20:48,881 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:20:50,233 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:20:51,880 - aiogram.event - INFO - Update id=785581709 is handled. Duration 891 ms by bot id=7987337779
2025-01-12 01:20:53,198 - aiogram.event - INFO - Update id=785581710 is not handled. Duration 47 ms by bot id=7987337779
2025-01-12 01:20:53,198 - aiogram.event - ERROR - Cause exception while process update id=785581710 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 39, in profile_button_pressed
    await profile.profile_command(fake_message)
  File "D:\Programming\Python\RunnerBot\bot\handlers\profile.py", line 43, in profile_command
    await message.answer_photo(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 89, in __await__
    raise RuntimeError(
RuntimeError: This method is not mounted to a any bot instance, please call it explicilty with bot instance `await bot(method)`
or mount method to a bot instance `method.as_(bot)` and then call it `await method`

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 01:21:34,459 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:21:34,480 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:21:34,739 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:22:07,992 - __main__ - INFO - Запуск main()
2025-01-12 01:22:07,993 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:22:08,007 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:22:08,028 - __main__ - INFO - Подключение middleware
2025-01-12 01:22:08,029 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:22:08,029 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:22:08,029 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:22:08,970 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:22:11,373 - aiogram.event - INFO - Update id=785581711 is handled. Duration 905 ms by bot id=7987337779
2025-01-12 01:22:12,803 - aiogram.event - INFO - Update id=785581712 is handled. Duration 594 ms by bot id=7987337779
2025-01-12 01:22:35,819 - aiogram.event - INFO - Update id=785581713 is handled. Duration 1484 ms by bot id=7987337779
2025-01-12 01:25:30,538 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:25:30,538 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:25:30,793 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:25:34,959 - __main__ - INFO - Запуск main()
2025-01-12 01:25:34,960 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:25:34,961 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:25:34,971 - __main__ - INFO - Подключение middleware
2025-01-12 01:25:34,971 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:25:34,972 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:25:34,972 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:25:36,337 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:25:39,703 - aiogram.event - INFO - Update id=785581714 is handled. Duration 875 ms by bot id=7987337779
2025-01-12 01:25:41,049 - aiogram.event - INFO - Update id=785581715 is handled. Duration 563 ms by bot id=7987337779
2025-01-12 01:25:46,572 - aiogram.event - INFO - Update id=785581716 is handled. Duration 4375 ms by bot id=7987337779
2025-01-12 01:28:45,470 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:28:45,470 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:28:45,728 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:28:49,469 - __main__ - INFO - Запуск main()
2025-01-12 01:28:49,470 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:28:49,471 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:28:49,482 - __main__ - INFO - Подключение middleware
2025-01-12 01:28:49,482 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:28:49,482 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:28:49,482 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:28:50,381 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:28:57,329 - aiogram.event - INFO - Update id=785581717 is handled. Duration 890 ms by bot id=7987337779
2025-01-12 01:28:59,067 - aiogram.event - INFO - Update id=785581718 is handled. Duration 656 ms by bot id=7987337779
2025-01-12 01:30:20,925 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:30:20,926 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:30:21,183 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:30:24,060 - __main__ - INFO - Запуск main()
2025-01-12 01:30:24,061 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:30:24,062 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:30:24,073 - __main__ - INFO - Подключение middleware
2025-01-12 01:30:24,073 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:30:24,073 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:30:24,073 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:30:25,375 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:30:27,306 - aiogram.event - INFO - Update id=785581719 is handled. Duration 1203 ms by bot id=7987337779
2025-01-12 01:30:29,371 - aiogram.event - INFO - Update id=785581720 is handled. Duration 577 ms by bot id=7987337779
2025-01-12 01:34:30,999 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:34:30,999 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:34:31,249 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:34:47,349 - __main__ - INFO - Запуск main()
2025-01-12 01:34:47,350 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:34:47,351 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:34:47,361 - __main__ - INFO - Подключение middleware
2025-01-12 01:34:47,361 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:34:47,362 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:34:47,362 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:34:48,156 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:34:57,755 - aiogram.event - INFO - Update id=785581721 is handled. Duration 875 ms by bot id=7987337779
2025-01-12 01:34:58,655 - aiogram.event - INFO - Update id=785581722 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:34:58,655 - aiogram.event - ERROR - Cause exception while process update id=785581722 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 42, in profile_button_pressed
    await profile.profile_command(message)
  File "D:\Programming\Python\RunnerBot\bot\handlers\profile.py", line 43, in profile_command
    await message.answer_photo(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 89, in __await__
    raise RuntimeError(
RuntimeError: This method is not mounted to a any bot instance, please call it explicilty with bot instance `await bot(method)`
or mount method to a bot instance `method.as_(bot)` and then call it `await method`

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 01:46:11,366 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:46:11,387 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:46:11,648 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:46:19,108 - __main__ - INFO - Запуск main()
2025-01-12 01:46:19,109 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:46:19,123 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:46:19,145 - __main__ - INFO - Подключение middleware
2025-01-12 01:46:19,145 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:46:19,145 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:46:19,145 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:46:20,496 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:46:24,781 - aiogram.event - INFO - Update id=785581723 is handled. Duration 890 ms by bot id=7987337779
2025-01-12 01:46:26,490 - aiogram.event - INFO - Update id=785581724 is handled. Duration 561 ms by bot id=7987337779
2025-01-12 01:46:35,849 - aiogram.event - INFO - Update id=785581725 is handled. Duration 3672 ms by bot id=7987337779
2025-01-12 01:46:42,814 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:46:42,814 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:46:43,061 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:48:05,319 - __main__ - INFO - Запуск main()
2025-01-12 01:48:05,320 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:48:05,321 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:48:05,331 - __main__ - INFO - Подключение middleware
2025-01-12 01:48:05,331 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:48:05,331 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:48:05,332 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:48:06,171 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:48:18,468 - aiogram.event - INFO - Update id=785581726 is handled. Duration 5406 ms by bot id=7987337779
2025-01-12 01:48:21,261 - aiogram.event - INFO - Update id=785581727 is handled. Duration 452 ms by bot id=7987337779
2025-01-12 01:48:32,814 - aiogram.event - INFO - Update id=785581728 is handled. Duration 562 ms by bot id=7987337779
2025-01-12 01:48:43,262 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:48:43,262 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:48:43,514 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:56:28,407 - __main__ - INFO - Запуск main()
2025-01-12 01:56:28,422 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:56:28,469 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:56:28,519 - __main__ - INFO - Подключение middleware
2025-01-12 01:56:28,519 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:56:28,519 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:56:28,519 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:56:29,942 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:56:41,872 - aiogram.event - INFO - Update id=785581729 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 01:56:55,112 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:56:55,112 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:56:55,365 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:57:13,773 - __main__ - INFO - Запуск main()
2025-01-12 01:57:13,775 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:57:13,775 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:57:13,786 - __main__ - INFO - Подключение middleware
2025-01-12 01:57:13,786 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:57:13,786 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:57:13,786 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:57:14,633 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:57:17,252 - aiogram.event - INFO - Update id=785581730 is handled. Duration 891 ms by bot id=7987337779
2025-01-12 01:57:52,564 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 01:57:52,565 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:57:52,820 - __main__ - INFO - Закрытие сессии бота
2025-01-12 01:58:34,897 - __main__ - INFO - Запуск main()
2025-01-12 01:58:34,898 - __main__ - INFO - Инициализация базы данных
2025-01-12 01:58:34,898 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 01:58:34,909 - __main__ - INFO - Подключение middleware
2025-01-12 01:58:34,909 - __main__ - INFO - Регистрация хендлеров
2025-01-12 01:58:34,909 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 01:58:34,909 - aiogram.dispatcher - INFO - Start polling
2025-01-12 01:58:36,133 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 01:58:54,313 - aiogram.event - INFO - Update id=785581731 is handled. Duration 1140 ms by bot id=7987337779
2025-01-12 01:58:57,784 - aiogram.event - INFO - Update id=785581732 is handled. Duration 327 ms by bot id=7987337779
2025-01-12 01:59:03,972 - aiogram.event - INFO - Update id=785581733 is handled. Duration 281 ms by bot id=7987337779
2025-01-12 01:59:09,856 - aiogram.event - INFO - Update id=785581734 is handled. Duration 405 ms by bot id=7987337779
2025-01-12 01:59:12,577 - aiogram.event - INFO - Update id=785581735 is handled. Duration 327 ms by bot id=7987337779
2025-01-12 02:00:12,201 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:00:12,201 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:00:12,456 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:03:56,822 - __main__ - INFO - Запуск main()
2025-01-12 02:03:56,823 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:03:56,823 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:03:56,834 - __main__ - INFO - Подключение middleware
2025-01-12 02:03:56,834 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:03:56,834 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:03:56,834 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:03:58,046 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:04:31,327 - aiogram.event - INFO - Update id=785581736 is handled. Duration 812 ms by bot id=7987337779
2025-01-12 02:04:49,447 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:04:49,447 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:04:49,699 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:09:48,275 - __main__ - INFO - Запуск main()
2025-01-12 02:09:48,276 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:09:48,277 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:09:48,288 - __main__ - INFO - Подключение middleware
2025-01-12 02:09:48,288 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:09:48,288 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:09:48,288 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:09:52,556 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:10:21,685 - aiogram.event - INFO - Update id=785581737 is handled. Duration 2047 ms by bot id=7987337779
2025-01-12 02:10:22,617 - aiogram.event - INFO - Update id=785581738 is handled. Duration 1218 ms by bot id=7987337779
2025-01-12 02:10:25,775 - aiogram.event - INFO - Update id=785581739 is not handled. Duration 93 ms by bot id=7987337779
2025-01-12 02:10:25,775 - aiogram.event - ERROR - Cause exception while process update id=785581739 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:10:54,556 - aiogram.event - INFO - Update id=785581740 is handled. Duration 328 ms by bot id=7987337779
2025-01-12 02:10:56,125 - aiogram.event - INFO - Update id=785581741 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:10:56,125 - aiogram.event - ERROR - Cause exception while process update id=785581741 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:11:42,538 - aiogram.event - INFO - Update id=785581742 is handled. Duration 343 ms by bot id=7987337779
2025-01-12 02:11:44,995 - aiogram.event - INFO - Update id=785581743 is not handled. Duration 16 ms by bot id=7987337779
2025-01-12 02:11:44,995 - aiogram.event - ERROR - Cause exception while process update id=785581743 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:11:50,883 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:11:50,883 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:11:51,135 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:12:03,582 - __main__ - INFO - Запуск main()
2025-01-12 02:12:03,583 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:12:03,584 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:12:03,594 - __main__ - INFO - Подключение middleware
2025-01-12 02:12:03,594 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:12:03,594 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:12:03,594 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:12:04,836 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:12:06,296 - aiogram.event - INFO - Update id=785581744 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:12:06,296 - aiogram.event - ERROR - Cause exception while process update id=785581744 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:12:34,375 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:12:34,376 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:12:34,628 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:12:51,166 - __main__ - INFO - Запуск main()
2025-01-12 02:12:51,167 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:12:51,168 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:12:51,179 - __main__ - INFO - Подключение middleware
2025-01-12 02:12:51,179 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:12:51,179 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:12:51,179 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:12:51,965 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:12:53,093 - aiogram.event - INFO - Update id=785581745 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:12:53,093 - aiogram.event - ERROR - Cause exception while process update id=785581745 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:13:15,085 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:13:15,086 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:13:15,343 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:14:08,800 - __main__ - INFO - Запуск main()
2025-01-12 02:14:08,801 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:14:08,802 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:14:08,813 - __main__ - INFO - Подключение middleware
2025-01-12 02:14:08,813 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:14:08,813 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:14:08,813 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:14:09,596 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:14:33,192 - aiogram.event - INFO - Update id=785581746 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:14:33,192 - aiogram.event - ERROR - Cause exception while process update id=785581746 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:14:42,320 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:14:42,321 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:14:42,584 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:14:55,163 - __main__ - INFO - Запуск main()
2025-01-12 02:14:55,164 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:14:55,165 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:14:55,175 - __main__ - INFO - Подключение middleware
2025-01-12 02:14:55,175 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:14:55,175 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:14:55,175 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:14:56,119 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:15:00,802 - aiogram.event - INFO - Update id=785581747 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:15:00,802 - aiogram.event - ERROR - Cause exception while process update id=785581747 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:15:05,305 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:15:05,306 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:15:05,556 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:15:30,780 - __main__ - INFO - Запуск main()
2025-01-12 02:15:30,781 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:15:30,781 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:15:30,792 - __main__ - INFO - Подключение middleware
2025-01-12 02:15:30,792 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:15:30,792 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:15:30,792 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:15:32,028 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:15:34,384 - aiogram.event - INFO - Update id=785581748 is not handled. Duration 15 ms by bot id=7987337779
2025-01-12 02:15:34,384 - aiogram.event - ERROR - Cause exception while process update id=785581748 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 55, in year_statistics_command
    monthly_stats = group_trainings_by_month(trainings)
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 26, in group_trainings_by_month
    month = datetime.strptime(date, "%Y-%m-%d").strftime("%Y-%m")
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 568, in _strptime_datetime
    tt, fraction, gmtoff_fraction = _strptime(data_string, format)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\_strptime.py", line 352, in _strptime
    raise ValueError("unconverted data remains: %s" %
ValueError: unconverted data remains:  16:48:14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:15:49,381 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:15:49,382 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:15:49,635 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:18:02,217 - __main__ - INFO - Запуск main()
2025-01-12 02:18:02,218 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:18:02,218 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:18:02,229 - __main__ - INFO - Подключение middleware
2025-01-12 02:18:02,229 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:18:02,229 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:18:02,229 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:18:03,080 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:18:04,827 - aiogram.event - INFO - Update id=785581749 is handled. Duration 905 ms by bot id=7987337779
2025-01-12 02:19:39,960 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:19:39,960 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:19:40,225 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:19:44,241 - __main__ - INFO - Запуск main()
2025-01-12 02:19:44,242 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:19:44,243 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:19:44,253 - __main__ - INFO - Подключение middleware
2025-01-12 02:19:44,254 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:19:44,254 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:19:44,254 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:19:45,081 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:20:12,881 - aiogram.event - INFO - Update id=785581750 is not handled. Duration 47 ms by bot id=7987337779
2025-01-12 02:20:12,881 - aiogram.event - ERROR - Cause exception while process update id=785581750 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 85, in year_statistics_command
    text += f"   - Суммарное время: {stats['total_duration']:.2f} мин\n\n"
ValueError: Unknown format code 'f' for object of type 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:20:32,064 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:20:32,064 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:20:32,328 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:22:19,497 - __main__ - INFO - Запуск main()
2025-01-12 02:22:19,498 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:22:19,498 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:22:19,510 - __main__ - INFO - Подключение middleware
2025-01-12 02:22:19,510 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:22:19,510 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:22:19,510 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:22:20,732 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:22:21,718 - aiogram.event - INFO - Update id=785581751 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:22:21,718 - aiogram.event - ERROR - Cause exception while process update id=785581751 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 86, in year_statistics_command
    text += f"   - Суммарное время: {stats['total_duration']:.2f} мин\n\n"
ValueError: Unknown format code 'f' for object of type 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:22:26,072 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:22:26,072 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:22:26,332 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:30:02,435 - __main__ - INFO - Запуск main()
2025-01-12 02:30:02,436 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:30:02,437 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:30:02,448 - __main__ - INFO - Подключение middleware
2025-01-12 02:30:02,448 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:30:02,448 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:30:02,448 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:30:03,710 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:30:06,203 - aiogram.event - INFO - Update id=785581752 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:30:06,203 - aiogram.event - ERROR - Cause exception while process update id=785581752 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\year_statistic.py", line 74, in year_statistics_command
    total_duration += stats["total_duration"]
TypeError: unsupported operand type(s) for +=: 'int' and 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 02:30:13,598 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:30:13,598 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:30:13,858 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:31:31,318 - __main__ - INFO - Запуск main()
2025-01-12 02:31:31,319 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:31:31,320 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:31:31,331 - __main__ - INFO - Подключение middleware
2025-01-12 02:31:31,331 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:31:31,331 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:31:31,331 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:31:32,073 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:31:42,968 - aiogram.event - INFO - Update id=785581753 is handled. Duration 844 ms by bot id=7987337779
2025-01-12 02:32:15,018 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:32:15,018 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:32:15,265 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:50:51,979 - __main__ - INFO - Запуск main()
2025-01-12 02:50:52,034 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:50:52,085 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:50:52,155 - __main__ - INFO - Подключение middleware
2025-01-12 02:50:52,155 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:50:52,155 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:50:52,155 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:50:53,635 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:51:15,496 - aiogram.event - INFO - Update id=785581754 is handled. Duration 2280 ms by bot id=7987337779
2025-01-12 02:51:18,383 - aiogram.event - INFO - Update id=785581755 is handled. Duration 547 ms by bot id=7987337779
2025-01-12 02:51:33,180 - aiogram.event - INFO - Update id=785581756 is handled. Duration 266 ms by bot id=7987337779
2025-01-12 02:51:36,980 - aiogram.event - INFO - Update id=785581757 is handled. Duration 436 ms by bot id=7987337779
2025-01-12 02:51:47,547 - aiogram.event - INFO - Update id=785581758 is handled. Duration 391 ms by bot id=7987337779
2025-01-12 02:51:51,532 - aiogram.event - INFO - Update id=785581759 is handled. Duration 422 ms by bot id=7987337779
2025-01-12 02:51:54,523 - aiogram.event - INFO - Update id=785581760 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:51:58,603 - aiogram.event - INFO - Update id=785581761 is not handled. Duration 14 ms by bot id=7987337779
2025-01-12 02:52:03,407 - aiogram.event - INFO - Update id=785581762 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:52:08,607 - aiogram.event - INFO - Update id=785581763 is handled. Duration 2968 ms by bot id=7987337779
2025-01-12 02:52:17,476 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:52:17,489 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:52:17,742 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:54:57,805 - __main__ - INFO - Запуск main()
2025-01-12 02:54:57,806 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:54:57,807 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:54:57,818 - __main__ - INFO - Подключение middleware
2025-01-12 02:54:57,818 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:54:57,818 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:54:57,818 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:54:59,071 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:55:00,598 - aiogram.event - INFO - Update id=785581764 is handled. Duration 1141 ms by bot id=7987337779
2025-01-12 02:55:03,625 - aiogram.event - INFO - Update id=785581765 is handled. Duration 280 ms by bot id=7987337779
2025-01-12 02:55:07,178 - aiogram.event - INFO - Update id=785581766 is handled. Duration 281 ms by bot id=7987337779
2025-01-12 02:55:10,800 - aiogram.event - INFO - Update id=785581767 is handled. Duration 313 ms by bot id=7987337779
2025-01-12 02:55:14,845 - aiogram.event - INFO - Update id=785581768 is handled. Duration 391 ms by bot id=7987337779
2025-01-12 02:55:19,547 - aiogram.event - INFO - Update id=785581769 is handled. Duration 266 ms by bot id=7987337779
2025-01-12 02:55:24,716 - aiogram.event - INFO - Update id=785581770 is handled. Duration 406 ms by bot id=7987337779
2025-01-12 02:55:36,319 - aiogram.event - INFO - Update id=785581771 is handled. Duration 1422 ms by bot id=7987337779
2025-01-12 02:55:59,211 - aiogram.event - INFO - Update id=785581772 is handled. Duration 672 ms by bot id=7987337779
2025-01-12 02:56:00,887 - aiogram.event - INFO - Update id=785581773 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 02:56:09,268 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:56:09,268 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:56:09,517 - __main__ - INFO - Закрытие сессии бота
2025-01-12 02:56:33,108 - __main__ - INFO - Запуск main()
2025-01-12 02:56:33,109 - __main__ - INFO - Инициализация базы данных
2025-01-12 02:56:33,110 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 02:56:33,121 - __main__ - INFO - Подключение middleware
2025-01-12 02:56:33,121 - __main__ - INFO - Регистрация хендлеров
2025-01-12 02:56:33,121 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 02:56:33,121 - aiogram.dispatcher - INFO - Start polling
2025-01-12 02:56:33,945 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:56:36,705 - aiogram.event - INFO - Update id=785581774 is handled. Duration 1969 ms by bot id=7987337779
2025-01-12 02:56:39,911 - aiogram.event - INFO - Update id=785581775 is handled. Duration 561 ms by bot id=7987337779
2025-01-12 02:56:42,682 - aiogram.event - INFO - Update id=785581776 is handled. Duration 297 ms by bot id=7987337779
2025-01-12 02:56:45,373 - aiogram.event - INFO - Update id=785581777 is handled. Duration 452 ms by bot id=7987337779
2025-01-12 02:56:58,031 - aiogram.event - INFO - Update id=785581778 is handled. Duration 265 ms by bot id=7987337779
2025-01-12 02:57:02,663 - aiogram.event - INFO - Update id=785581779 is handled. Duration 405 ms by bot id=7987337779
2025-01-12 02:57:06,879 - aiogram.event - INFO - Update id=785581780 is handled. Duration 1312 ms by bot id=7987337779
2025-01-12 02:57:12,329 - aiogram.event - INFO - Update id=785581781 is handled. Duration 327 ms by bot id=7987337779
2025-01-12 02:57:15,081 - aiogram.event - INFO - Update id=785581782 is handled. Duration 625 ms by bot id=7987337779
2025-01-12 02:57:16,734 - aiogram.event - INFO - Update id=785581783 is handled. Duration 327 ms by bot id=7987337779
2025-01-12 02:57:19,399 - aiogram.event - INFO - Update id=785581784 is handled. Duration 312 ms by bot id=7987337779
2025-01-12 02:57:26,102 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 02:57:26,102 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 02:57:26,356 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:12:07,475 - __main__ - INFO - Запуск main()
2025-01-12 03:12:07,581 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:12:07,654 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:12:07,679 - __main__ - INFO - Подключение middleware
2025-01-12 03:12:07,679 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:12:07,679 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:12:07,680 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:12:15,296 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:12:15,424 - bot.handlers.start - INFO - Пользователь 615014924 вызвал команду /start
2025-01-12 03:12:15,444 - bot.handlers.start - INFO - Пользователь 615014924 уже зарегистрирован
2025-01-12 03:12:15,696 - aiogram.event - INFO - Update id=785581786 is not handled. Duration 235 ms by bot id=7987337779
2025-01-12 03:12:15,696 - aiogram.event - ERROR - Cause exception while process update id=785581786 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client_reqrep.py", line 658, in write_bytes
    await self.body.write(writer)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\multipart.py", line 1008, in write
    await part.write(writer)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\payload.py", line 494, in write
    chunk = await self._iter.__anext__()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\types\input_file.py", line 103, in read
    async with aiofiles.open(self.path, "rb") as f:
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\base.py", line 63, in __aenter__
    return await self
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\threadpool\__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
FileNotFoundError: [Errno 2] No such file or directory: '../data/images/menu_image.jpg'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client.py", line 730, in _request
    await resp.start(conn)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client_reqrep.py", line 1059, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\streams.py", line 671, in read
    await self._waiter
aiohttp.client_exceptions.ClientOSError: [Errno 2] Can not write request body for https://api.telegram.org/bot7987337779:AAE1UGY2a_lPa1_E14QHi2arW7FtuRkmp1Y/sendPhoto

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 31, in menu_command
    await message.answer_photo(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 2] Can not write request body for https://api.telegram.org/bot7987337779:AAE1UGY2a_lPa1_E14QHi2arW7FtuRkmp1Y/sendPhoto

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 03:12:16,653 - aiogram.event - INFO - Update id=785581785 is handled. Duration 1234 ms by bot id=7987337779
2025-01-12 03:12:16,653 - asyncio - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] Удаленный хост принудительно разорвал существующее подключение
2025-01-12 03:12:19,707 - aiogram.event - INFO - Update id=785581787 is not handled. Duration 0 ms by bot id=7987337779
2025-01-12 03:12:19,708 - aiogram.event - ERROR - Cause exception while process update id=785581787 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client_reqrep.py", line 658, in write_bytes
    await self.body.write(writer)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\multipart.py", line 1008, in write
    await part.write(writer)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\payload.py", line 494, in write
    chunk = await self._iter.__anext__()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\types\input_file.py", line 103, in read
    async with aiofiles.open(self.path, "rb") as f:
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\base.py", line 63, in __aenter__
    return await self
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\base.py", line 59, in __await__
    self._obj = yield from self._coro.__await__()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiofiles\threadpool\__init__.py", line 92, in _open
    f = await loop.run_in_executor(executor, cb)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
FileNotFoundError: [Errno 2] No such file or directory: '../data/images/menu_image.jpg'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\aiohttp.py", line 181, in make_request
    async with session.post(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client.py", line 1425, in __aenter__
    self._resp: _RetType = await self._coro
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client.py", line 730, in _request
    await resp.start(conn)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\client_reqrep.py", line 1059, in start
    message, payload = await protocol.read()  # type: ignore[union-attr]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiohttp\streams.py", line 671, in read
    await self._waiter
aiohttp.client_exceptions.ClientOSError: [Errno 2] Can not write request body for https://api.telegram.org/bot7987337779:AAE1UGY2a_lPa1_E14QHi2arW7FtuRkmp1Y/sendPhoto

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\menu.py", line 31, in menu_command
    await message.answer_photo(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\methods\base.py", line 84, in emit
    return await bot(self)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\bot.py", line 498, in __call__
    return await self.session(self, method, timeout=request_timeout)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\base.py", line 254, in __call__
    return cast(TelegramType, await middleware(bot, method))
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\client\session\aiohttp.py", line 188, in make_request
    raise TelegramNetworkError(method=method, message=f"{type(e).__name__}: {e}")
aiogram.exceptions.TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 2] Can not write request body for https://api.telegram.org/bot7987337779:AAE1UGY2a_lPa1_E14QHi2arW7FtuRkmp1Y/sendPhoto

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 03:12:42,614 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:12:42,614 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:12:42,872 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:12:52,318 - __main__ - INFO - Запуск main()
2025-01-12 03:12:52,319 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:12:52,319 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:12:52,330 - __main__ - INFO - Подключение middleware
2025-01-12 03:12:52,330 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:12:52,330 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:12:52,330 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:12:52,599 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:12:55,300 - aiogram.event - INFO - Update id=785581788 is handled. Duration 1000 ms by bot id=7987337779
2025-01-12 03:13:37,013 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:13:37,013 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:13:37,276 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:13:40,878 - __main__ - INFO - Запуск main()
2025-01-12 03:13:40,879 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:13:40,880 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:13:40,891 - __main__ - INFO - Подключение middleware
2025-01-12 03:13:40,891 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:13:40,891 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:13:40,891 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:13:41,146 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:13:43,944 - aiogram.event - INFO - Update id=785581789 is handled. Duration 813 ms by bot id=7987337779
2025-01-12 03:14:01,520 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:14:01,520 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:14:01,783 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:14:04,784 - __main__ - INFO - Запуск main()
2025-01-12 03:14:04,785 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:14:04,785 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:14:04,796 - __main__ - INFO - Подключение middleware
2025-01-12 03:14:04,796 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:14:04,796 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:14:04,796 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:14:05,065 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:14:07,449 - aiogram.event - INFO - Update id=785581790 is handled. Duration 844 ms by bot id=7987337779
2025-01-12 03:16:28,881 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:16:28,881 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:16:29,149 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:16:32,080 - __main__ - INFO - Запуск main()
2025-01-12 03:16:32,081 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:16:32,082 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:16:32,092 - __main__ - INFO - Подключение middleware
2025-01-12 03:16:32,092 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:16:32,093 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:16:32,093 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:16:32,409 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:16:38,007 - aiogram.event - INFO - Update id=785581791 is handled. Duration 452 ms by bot id=7987337779
2025-01-12 03:16:44,756 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:16:44,756 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:16:45,027 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:16:47,891 - __main__ - INFO - Запуск main()
2025-01-12 03:16:47,892 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:16:47,893 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:16:47,903 - __main__ - INFO - Подключение middleware
2025-01-12 03:16:47,903 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:16:47,904 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:16:47,904 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:16:48,180 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:16:51,501 - aiogram.event - INFO - Update id=785581792 is handled. Duration 390 ms by bot id=7987337779
2025-01-12 03:19:01,602 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-12 03:19:01,602 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-12 03:19:04,437 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Подключение к сети было разорвано локальной системой]
2025-01-12 03:19:04,438 - aiogram.dispatcher - WARNING - Sleep for 1.274097 seconds and try again... (tryings = 1, bot id = 7987337779)
2025-01-12 03:19:16,003 - aiogram.dispatcher - INFO - Connection established (tryings = 2, bot id = 7987337779)
2025-01-12 03:19:35,260 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-12 03:19:35,260 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-12 03:19:46,563 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-12 03:20:15,929 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-12 03:20:15,929 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-12 03:20:28,115 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-12 03:21:34,328 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:21:34,328 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:21:34,595 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:21:37,976 - __main__ - INFO - Запуск main()
2025-01-12 03:21:37,977 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:21:37,978 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:21:37,989 - __main__ - INFO - Подключение middleware
2025-01-12 03:21:37,989 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:21:37,989 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:21:37,989 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:21:39,370 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:21:57,566 - aiogram.event - INFO - Update id=785581793 is handled. Duration 1625 ms by bot id=7987337779
2025-01-12 03:22:46,484 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:22:46,484 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:22:46,746 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:22:49,710 - __main__ - INFO - Запуск main()
2025-01-12 03:22:49,711 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:22:49,712 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:22:49,722 - __main__ - INFO - Подключение middleware
2025-01-12 03:22:49,722 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:22:49,722 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:22:49,722 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:22:50,893 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:23:16,847 - aiogram.event - INFO - Update id=785581794 is handled. Duration 1577 ms by bot id=7987337779
2025-01-12 03:23:50,661 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:23:50,661 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:23:50,925 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:23:54,007 - __main__ - INFO - Запуск main()
2025-01-12 03:23:54,008 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:23:54,009 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:23:54,019 - __main__ - INFO - Подключение middleware
2025-01-12 03:23:54,019 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:23:54,020 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:23:54,020 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:23:55,221 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:24:03,413 - aiogram.event - INFO - Update id=785581795 is handled. Duration 1547 ms by bot id=7987337779
2025-01-12 03:24:16,007 - aiogram.event - INFO - Update id=785581796 is handled. Duration 797 ms by bot id=7987337779
2025-01-12 03:24:35,617 - aiogram.event - INFO - Update id=785581797 is handled. Duration 500 ms by bot id=7987337779
2025-01-12 03:24:37,966 - aiogram.event - INFO - Update id=785581798 is handled. Duration 811 ms by bot id=7987337779
2025-01-12 03:24:40,126 - aiogram.event - INFO - Update id=785581799 is handled. Duration 952 ms by bot id=7987337779
2025-01-12 03:25:05,929 - aiogram.event - INFO - Update id=785581800 is handled. Duration 2108 ms by bot id=7987337779
2025-01-12 03:25:35,348 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:25:35,348 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:25:35,614 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:25:38,780 - __main__ - INFO - Запуск main()
2025-01-12 03:25:38,781 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:25:38,782 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:25:38,793 - __main__ - INFO - Подключение middleware
2025-01-12 03:25:38,793 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:25:38,793 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:25:38,793 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:25:40,440 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:25:44,451 - bot.handlers.start - INFO - Пользователь 615014924 вызвал команду /start
2025-01-12 03:25:44,452 - bot.handlers.start - INFO - Пользователь 615014924 уже зарегистрирован
2025-01-12 03:25:45,693 - aiogram.event - INFO - Update id=785581801 is handled. Duration 1250 ms by bot id=7987337779
2025-01-12 03:25:49,110 - aiogram.event - INFO - Update id=785581802 is handled. Duration 1641 ms by bot id=7987337779
2025-01-12 03:27:07,394 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:27:07,394 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:27:07,658 - __main__ - INFO - Закрытие сессии бота
2025-01-12 03:27:10,628 - __main__ - INFO - Запуск main()
2025-01-12 03:27:10,629 - __main__ - INFO - Инициализация базы данных
2025-01-12 03:27:10,630 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 03:27:10,640 - __main__ - INFO - Подключение middleware
2025-01-12 03:27:10,641 - __main__ - INFO - Регистрация хендлеров
2025-01-12 03:27:10,641 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 03:27:10,641 - aiogram.dispatcher - INFO - Start polling
2025-01-12 03:27:11,801 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:27:15,633 - aiogram.event - INFO - Update id=785581803 is handled. Duration 1577 ms by bot id=7987337779
2025-01-12 03:27:17,157 - aiogram.event - INFO - Update id=785581804 is handled. Duration 781 ms by bot id=7987337779
2025-01-12 03:27:18,392 - aiogram.event - INFO - Update id=785581805 is handled. Duration 405 ms by bot id=7987337779
2025-01-12 03:27:20,750 - aiogram.event - INFO - Update id=785581806 is handled. Duration 796 ms by bot id=7987337779
2025-01-12 03:27:22,351 - aiogram.event - INFO - Update id=785581807 is handled. Duration 875 ms by bot id=7987337779
2025-01-12 03:27:25,935 - aiogram.event - INFO - Update id=785581808 is handled. Duration 1733 ms by bot id=7987337779
2025-01-12 03:30:31,977 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 03:30:31,977 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 03:30:32,242 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:09:50,437 - __main__ - INFO - Запуск main()
2025-01-12 23:09:50,510 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:09:50,806 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:09:50,911 - __main__ - INFO - Подключение middleware
2025-01-12 23:09:50,911 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:09:50,911 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:09:50,923 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:09:52,177 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:09:53,205 - bot.handlers.start - INFO - Пользователь 6453533068 вызвал команду /start
2025-01-12 23:09:53,935 - aiogram.event - INFO - Update id=785581809 is handled. Duration 797 ms by bot id=7987337779
2025-01-12 23:09:59,657 - aiogram.event - INFO - Update id=785581810 is handled. Duration 438 ms by bot id=7987337779
2025-01-12 23:10:18,362 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:10:18,362 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:10:18,602 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:10:25,975 - __main__ - INFO - Запуск main()
2025-01-12 23:10:25,976 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:10:25,976 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:10:25,987 - __main__ - INFO - Подключение middleware
2025-01-12 23:10:25,987 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:10:25,988 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:10:25,988 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:10:28,577 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:10:31,926 - aiogram.event - INFO - Update id=785581811 is handled. Duration 3109 ms by bot id=7987337779
2025-01-12 23:10:32,526 - aiogram.event - INFO - Update id=785581812 is handled. Duration 891 ms by bot id=7987337779
2025-01-12 23:10:50,989 - aiogram.event - INFO - Update id=785581813 is handled. Duration 859 ms by bot id=7987337779
2025-01-12 23:11:02,001 - aiogram.event - INFO - Update id=785581814 is handled. Duration 1406 ms by bot id=7987337779
2025-01-12 23:11:38,676 - aiogram.event - INFO - Update id=785581815 is handled. Duration 280 ms by bot id=7987337779
2025-01-12 23:11:43,837 - aiogram.event - INFO - Update id=785581816 is handled. Duration 3702 ms by bot id=7987337779
2025-01-12 23:11:46,604 - aiogram.event - INFO - Update id=785581817 is handled. Duration 469 ms by bot id=7987337779
2025-01-12 23:11:49,071 - aiogram.event - INFO - Update id=785581818 is handled. Duration 250 ms by bot id=7987337779
2025-01-12 23:11:52,251 - aiogram.event - INFO - Update id=785581819 is handled. Duration 562 ms by bot id=7987337779
2025-01-12 23:11:59,435 - aiogram.event - INFO - Update id=785581820 is handled. Duration 733 ms by bot id=7987337779
2025-01-12 23:12:05,545 - aiogram.event - INFO - Update id=785581821 is handled. Duration 1531 ms by bot id=7987337779
2025-01-12 23:12:09,599 - aiogram.event - INFO - Update id=785581822 is handled. Duration 297 ms by bot id=7987337779
2025-01-12 23:12:55,072 - aiogram.event - INFO - Update id=785581823 is handled. Duration 969 ms by bot id=7987337779
2025-01-12 23:13:06,704 - aiogram.event - INFO - Update id=785581824 is handled. Duration 469 ms by bot id=7987337779
2025-01-12 23:13:12,669 - aiogram.event - INFO - Update id=785581825 is handled. Duration 3500 ms by bot id=7987337779
2025-01-12 23:16:17,948 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:16:17,948 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:16:18,209 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:16:27,771 - __main__ - INFO - Запуск main()
2025-01-12 23:16:27,772 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:16:27,787 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:16:27,808 - __main__ - INFO - Подключение middleware
2025-01-12 23:16:27,808 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:16:27,808 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:16:27,808 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:16:33,451 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:16:42,249 - aiogram.event - INFO - Update id=785581826 is handled. Duration 2187 ms by bot id=7987337779
2025-01-12 23:16:49,099 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:16:49,100 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:16:49,359 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:21:10,595 - __main__ - INFO - Запуск main()
2025-01-12 23:21:10,669 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:21:10,727 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:21:10,765 - __main__ - INFO - Подключение middleware
2025-01-12 23:21:10,765 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:21:10,766 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:21:10,766 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:21:11,902 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:21:12,916 - aiogram.event - INFO - Update id=785581827 is handled. Duration 765 ms by bot id=7987337779
2025-01-12 23:21:19,481 - aiogram.event - INFO - Update id=785581828 is handled. Duration 1047 ms by bot id=7987337779
2025-01-12 23:21:24,295 - aiogram.event - INFO - Update id=785581829 is handled. Duration 281 ms by bot id=7987337779
2025-01-12 23:21:30,748 - aiogram.event - INFO - Update id=785581830 is handled. Duration 5265 ms by bot id=7987337779
2025-01-12 23:28:56,882 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:28:56,896 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:28:57,171 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:29:05,115 - __main__ - INFO - Запуск main()
2025-01-12 23:29:05,116 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:29:05,127 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:29:05,148 - __main__ - INFO - Подключение middleware
2025-01-12 23:29:05,149 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:29:05,149 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:29:05,149 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:29:06,340 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:30:10,125 - aiogram.event - INFO - Update id=785581831 is handled. Duration 687 ms by bot id=7987337779
2025-01-12 23:31:17,020 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:31:17,021 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:31:17,290 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:31:20,592 - __main__ - INFO - Запуск main()
2025-01-12 23:31:20,593 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:31:20,594 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:31:20,605 - __main__ - INFO - Подключение middleware
2025-01-12 23:31:20,605 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:31:20,605 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:31:20,605 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:31:21,670 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:31:22,862 - aiogram.event - INFO - Update id=785581832 is handled. Duration 750 ms by bot id=7987337779
2025-01-12 23:32:39,046 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:32:39,047 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:32:39,306 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:32:42,703 - __main__ - INFO - Запуск main()
2025-01-12 23:32:42,704 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:32:42,705 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:32:42,716 - __main__ - INFO - Подключение middleware
2025-01-12 23:32:42,716 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:32:42,716 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:32:42,716 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:32:43,386 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:32:47,231 - aiogram.event - INFO - Update id=785581833 is handled. Duration 797 ms by bot id=7987337779
2025-01-12 23:33:10,635 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:33:10,636 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:33:10,904 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:33:13,892 - __main__ - INFO - Запуск main()
2025-01-12 23:33:13,893 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:33:13,894 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:33:13,905 - __main__ - INFO - Подключение middleware
2025-01-12 23:33:13,905 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:33:13,905 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:33:13,905 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:33:14,635 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:33:16,212 - aiogram.event - INFO - Update id=785581834 is handled. Duration 686 ms by bot id=7987337779
2025-01-12 23:33:23,327 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:33:23,327 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:33:23,587 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:39:29,075 - __main__ - INFO - Запуск main()
2025-01-12 23:39:29,076 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:39:29,414 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:39:29,425 - __main__ - INFO - Подключение middleware
2025-01-12 23:39:29,425 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:39:29,425 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:39:29,426 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:39:30,476 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:57:09,664 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:57:09,728 - aiogram.dispatcher - INFO - Polling stopped
2025-01-12 23:57:10,081 - __main__ - INFO - Закрытие сессии бота
2025-01-12 23:57:20,859 - __main__ - INFO - Запуск main()
2025-01-12 23:57:20,860 - __main__ - INFO - Инициализация базы данных
2025-01-12 23:57:20,861 - __main__ - INFO - Настройка бота и диспетчера
2025-01-12 23:57:20,890 - __main__ - INFO - Подключение middleware
2025-01-12 23:57:20,890 - __main__ - INFO - Регистрация хендлеров
2025-01-12 23:57:20,890 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-12 23:57:20,896 - aiogram.dispatcher - INFO - Start polling
2025-01-12 23:57:21,940 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-12 23:57:34,404 - aiogram.event - INFO - Update id=785581835 is handled. Duration 3109 ms by bot id=7987337779
2025-01-12 23:57:36,042 - aiogram.event - INFO - Update id=785581836 is handled. Duration 500 ms by bot id=7987337779
2025-01-12 23:57:39,087 - aiogram.event - INFO - Update id=785581837 is handled. Duration 1858 ms by bot id=7987337779
2025-01-12 23:57:51,010 - aiogram.event - INFO - Update id=785581838 is handled. Duration 233 ms by bot id=7987337779
2025-01-12 23:57:53,343 - aiogram.event - INFO - Update id=785581839 is handled. Duration 733 ms by bot id=7987337779
2025-01-12 23:57:58,149 - aiogram.event - INFO - Update id=785581840 is not handled. Duration 359 ms by bot id=7987337779
2025-01-12 23:57:58,149 - aiogram.event - ERROR - Cause exception while process update id=785581840 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 21, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\add_run.py", line 70, in process_duration
    add_achievement(user_id, achievement)
  File "D:\Programming\Python\RunnerBot\bot\utils\db.py", line 275, in add_achievement
    cursor.execute("""
sqlite3.OperationalError: no such column: user_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-12 23:58:38,840 - aiogram.event - INFO - Update id=785581841 is handled. Duration 280 ms by bot id=7987337779
2025-01-12 23:58:45,606 - aiogram.event - INFO - Update id=785581842 is handled. Duration 297 ms by bot id=7987337779
2025-01-13 00:00:19,578 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:00:19,578 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:00:19,841 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:00:34,501 - __main__ - INFO - Запуск main()
2025-01-13 00:00:34,502 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:00:34,503 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:00:34,531 - __main__ - INFO - Подключение middleware
2025-01-13 00:00:34,531 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:00:34,531 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:00:34,532 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:00:38,728 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:00:42,021 - aiogram.event - INFO - Update id=785581843 is handled. Duration 3063 ms by bot id=7987337779
2025-01-13 00:00:51,076 - aiogram.event - INFO - Update id=785581844 is handled. Duration 313 ms by bot id=7987337779
2025-01-13 00:00:56,052 - aiogram.event - INFO - Update id=785581845 is handled. Duration 437 ms by bot id=7987337779
2025-01-13 00:01:06,725 - aiogram.event - INFO - Update id=785581846 is handled. Duration 391 ms by bot id=7987337779
2025-01-13 00:01:28,597 - aiogram.event - INFO - Update id=785581847 is handled. Duration 2171 ms by bot id=7987337779
2025-01-13 00:01:36,306 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:01:36,306 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:01:36,569 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:02:56,108 - __main__ - INFO - Запуск main()
2025-01-13 00:02:56,109 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:02:56,110 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:02:56,139 - __main__ - INFO - Подключение middleware
2025-01-13 00:02:56,139 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:02:56,139 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:02:56,139 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:02:56,860 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:03:18,181 - aiogram.event - INFO - Update id=785581848 is handled. Duration 1577 ms by bot id=7987337779
2025-01-13 00:03:22,108 - aiogram.event - INFO - Update id=785581849 is handled. Duration 312 ms by bot id=7987337779
2025-01-13 00:03:24,042 - aiogram.event - INFO - Update id=785581850 is handled. Duration 250 ms by bot id=7987337779
2025-01-13 00:03:27,977 - aiogram.event - INFO - Update id=785581851 is not handled. Duration 327 ms by bot id=7987337779
2025-01-13 00:03:27,978 - aiogram.event - ERROR - Cause exception while process update id=785581851 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 21, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\add_run.py", line 71, in process_duration
    add_achievement(user_id, achievement)
  File "D:\Programming\Python\RunnerBot\bot\utils\db.py", line 275, in add_achievement
    cursor.execute("""
sqlite3.OperationalError: no such column: user_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 00:03:45,898 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:03:45,898 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:03:46,174 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:06:25,597 - __main__ - INFO - Запуск main()
2025-01-13 00:06:25,598 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:06:25,599 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:06:25,610 - __main__ - INFO - Подключение middleware
2025-01-13 00:06:25,610 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:06:25,610 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:06:25,610 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:06:26,821 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:06:30,050 - aiogram.event - INFO - Update id=785581852 is handled. Duration 2453 ms by bot id=7987337779
2025-01-13 00:06:33,933 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:06:33,933 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:06:34,201 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:06:52,896 - __main__ - INFO - Запуск main()
2025-01-13 00:06:52,897 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:06:52,898 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:06:52,909 - __main__ - INFO - Подключение middleware
2025-01-13 00:06:52,909 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:06:52,909 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:06:52,909 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:06:53,619 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:06:59,493 - aiogram.event - INFO - Update id=785581853 is handled. Duration 1406 ms by bot id=7987337779
2025-01-13 00:07:03,323 - aiogram.event - INFO - Update id=785581854 is handled. Duration 328 ms by bot id=7987337779
2025-01-13 00:07:06,045 - aiogram.event - INFO - Update id=785581855 is handled. Duration 265 ms by bot id=7987337779
2025-01-13 00:07:11,538 - aiogram.event - INFO - Update id=785581856 is not handled. Duration 359 ms by bot id=7987337779
2025-01-13 00:07:11,538 - aiogram.event - ERROR - Cause exception while process update id=785581856 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 21, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\add_run.py", line 71, in process_duration
    add_achievement(user_id, achievement)
  File "D:\Programming\Python\RunnerBot\bot\utils\db.py", line 275, in add_achievement
    cursor.execute("""
sqlite3.OperationalError: no such column: user_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 00:08:46,797 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:08:46,797 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:08:47,051 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:10:10,237 - __main__ - INFO - Запуск main()
2025-01-13 00:10:10,237 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:10:10,238 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:10:10,249 - __main__ - INFO - Подключение middleware
2025-01-13 00:10:10,249 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:10:10,249 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:10:10,249 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:10:11,363 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:10:20,696 - aiogram.event - INFO - Update id=785581857 is handled. Duration 703 ms by bot id=7987337779
2025-01-13 00:10:23,546 - aiogram.event - INFO - Update id=785581858 is handled. Duration 468 ms by bot id=7987337779
2025-01-13 00:10:28,733 - aiogram.event - INFO - Update id=785581859 is not handled. Duration 327 ms by bot id=7987337779
2025-01-13 00:10:28,733 - aiogram.event - ERROR - Cause exception while process update id=785581859 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 21, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\add_run.py", line 70, in process_duration
    add_achievement(user_id, achievement)
  File "D:\Programming\Python\RunnerBot\bot\utils\db.py", line 275, in add_achievement
    cursor.execute("""
sqlite3.OperationalError: no such column: user_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 00:13:43,078 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:13:43,079 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:13:43,340 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:13:46,848 - __main__ - INFO - Запуск main()
2025-01-13 00:13:46,849 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:13:46,849 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:13:46,860 - __main__ - INFO - Подключение middleware
2025-01-13 00:13:46,860 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:13:46,860 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:13:46,860 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:13:47,680 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:13:52,156 - aiogram.event - INFO - Update id=785581860 is handled. Duration 702 ms by bot id=7987337779
2025-01-13 00:13:54,527 - aiogram.event - INFO - Update id=785581861 is handled. Duration 250 ms by bot id=7987337779
2025-01-13 00:14:00,385 - aiogram.event - INFO - Update id=785581862 is handled. Duration 452 ms by bot id=7987337779
2025-01-13 00:15:12,816 - aiogram.event - INFO - Update id=785581863 is handled. Duration 297 ms by bot id=7987337779
2025-01-13 00:15:14,970 - aiogram.event - INFO - Update id=785581864 is handled. Duration 296 ms by bot id=7987337779
2025-01-13 00:15:19,033 - aiogram.event - INFO - Update id=785581865 is handled. Duration 827 ms by bot id=7987337779
2025-01-13 00:15:53,572 - aiogram.event - INFO - Update id=785581866 is handled. Duration 266 ms by bot id=7987337779
2025-01-13 00:16:07,439 - aiogram.event - INFO - Update id=785581867 is handled. Duration 875 ms by bot id=7987337779
2025-01-13 00:16:12,832 - aiogram.event - INFO - Update id=785581868 is handled. Duration 235 ms by bot id=7987337779
2025-01-13 00:16:21,633 - aiogram.event - INFO - Update id=785581869 is handled. Duration 1093 ms by bot id=7987337779
2025-01-13 00:16:39,879 - aiogram.event - INFO - Update id=785581870 is handled. Duration 250 ms by bot id=7987337779
2025-01-13 00:16:42,975 - aiogram.event - INFO - Update id=785581871 is handled. Duration 1297 ms by bot id=7987337779
2025-01-13 00:16:51,620 - aiogram.event - INFO - Update id=785581872 is handled. Duration 343 ms by bot id=7987337779
2025-01-13 00:16:54,793 - aiogram.event - INFO - Update id=785581873 is handled. Duration 297 ms by bot id=7987337779
2025-01-13 00:16:58,119 - aiogram.event - INFO - Update id=785581874 is handled. Duration 250 ms by bot id=7987337779
2025-01-13 00:17:02,149 - aiogram.event - INFO - Update id=785581875 is handled. Duration 406 ms by bot id=7987337779
2025-01-13 00:17:07,131 - aiogram.event - INFO - Update id=785581876 is handled. Duration 750 ms by bot id=7987337779
2025-01-13 00:17:11,161 - aiogram.event - INFO - Update id=785581877 is handled. Duration 297 ms by bot id=7987337779
2025-01-13 00:17:21,081 - aiogram.event - INFO - Update id=785581878 is handled. Duration 1281 ms by bot id=7987337779
2025-01-13 00:18:28,248 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:18:28,248 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:18:28,500 - __main__ - INFO - Закрытие сессии бота
2025-01-13 00:25:01,962 - __main__ - INFO - Запуск main()
2025-01-13 00:25:01,962 - __main__ - INFO - Инициализация базы данных
2025-01-13 00:25:01,963 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 00:25:01,974 - __main__ - INFO - Подключение middleware
2025-01-13 00:25:01,974 - __main__ - INFO - Регистрация хендлеров
2025-01-13 00:25:01,974 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 00:25:01,975 - aiogram.dispatcher - INFO - Start polling
2025-01-13 00:25:02,975 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:25:34,593 - aiogram.event - INFO - Update id=785581879 is handled. Duration 11468 ms by bot id=7987337779
2025-01-13 00:25:54,941 - aiogram.event - INFO - Update id=785581880 is handled. Duration 547 ms by bot id=7987337779
2025-01-13 00:26:03,661 - aiogram.event - INFO - Update id=785581881 is handled. Duration 7640 ms by bot id=7987337779
2025-01-13 00:26:07,973 - aiogram.event - INFO - Update id=785581882 is handled. Duration 500 ms by bot id=7987337779
2025-01-13 00:26:09,826 - aiogram.event - INFO - Update id=785581883 is handled. Duration 235 ms by bot id=7987337779
2025-01-13 00:26:14,373 - aiogram.event - INFO - Update id=785581884 is handled. Duration 265 ms by bot id=7987337779
2025-01-13 00:26:28,043 - aiogram.event - INFO - Update id=785581885 is handled. Duration 797 ms by bot id=7987337779
2025-01-13 00:26:42,725 - aiogram.event - INFO - Update id=785581886 is handled. Duration 297 ms by bot id=7987337779
2025-01-13 00:26:49,229 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 00:26:49,229 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 00:26:49,495 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:15:03,204 - __main__ - INFO - Запуск main()
2025-01-13 01:15:03,400 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:15:03,631 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:15:03,661 - __main__ - INFO - Подключение middleware
2025-01-13 01:15:03,661 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:15:03,661 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:15:03,662 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:15:05,786 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:15:22,410 - aiogram.event - INFO - Update id=785581887 is not handled. Duration 172 ms by bot id=7987337779
2025-01-13 01:15:22,410 - aiogram.event - ERROR - Cause exception while process update id=785581887 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 34, in get_user_chain
    return ConversationChain(llm=llm, prompt=prompt, memory=memory)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ConversationChain
  Value error, Got unexpected prompt input variables. The prompt expects ['input'], but got ['history'] as inputs from memory, and input as the normal input key. [type=value_error, input_value={'llm': GigaChat(credenti...geHistory(messages=[]))}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:15:48,912 - aiogram.event - INFO - Update id=785581888 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:15:48,913 - aiogram.event - ERROR - Cause exception while process update id=785581888 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 34, in get_user_chain
    return ConversationChain(llm=llm, prompt=prompt, memory=memory)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ConversationChain
  Value error, Got unexpected prompt input variables. The prompt expects ['input'], but got ['history'] as inputs from memory, and input as the normal input key. [type=value_error, input_value={'llm': GigaChat(credenti...geHistory(messages=[]))}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:15:57,441 - aiogram.event - INFO - Update id=785581889 is handled. Duration 1452 ms by bot id=7987337779
2025-01-13 01:15:59,382 - aiogram.event - INFO - Update id=785581890 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:15:59,382 - aiogram.event - ERROR - Cause exception while process update id=785581890 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 34, in get_user_chain
    return ConversationChain(llm=llm, prompt=prompt, memory=memory)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ConversationChain
  Value error, Got unexpected prompt input variables. The prompt expects ['input'], but got ['history'] as inputs from memory, and input as the normal input key. [type=value_error, input_value={'llm': GigaChat(credenti...geHistory(messages=[]))}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:16:06,766 - aiogram.event - INFO - Update id=785581891 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:16:06,766 - aiogram.event - ERROR - Cause exception while process update id=785581891 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 34, in get_user_chain
    return ConversationChain(llm=llm, prompt=prompt, memory=memory)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ConversationChain
  Value error, Got unexpected prompt input variables. The prompt expects ['input'], but got ['history'] as inputs from memory, and input as the normal input key. [type=value_error, input_value={'llm': GigaChat(credenti...geHistory(messages=[]))}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:17:06,142 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:17:06,142 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:17:06,399 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:17:11,382 - __main__ - INFO - Запуск main()
2025-01-13 01:17:11,383 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:17:11,384 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:17:11,396 - __main__ - INFO - Подключение middleware
2025-01-13 01:17:11,396 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:17:11,396 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:17:11,396 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:17:12,649 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:17:14,641 - aiogram.event - INFO - Update id=785581892 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:17:14,641 - aiogram.event - ERROR - Cause exception while process update id=785581892 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 34, in get_user_chain
    return ConversationChain(llm=llm, prompt=prompt, memory=memory)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for ConversationChain
  Value error, Got unexpected prompt input variables. The prompt expects ['input'], but got ['history'] as inputs from memory, and input as the normal input key. [type=value_error, input_value={'llm': GigaChat(credenti...geHistory(messages=[]))}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/value_error

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:26:07,468 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:26:07,489 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:26:07,749 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:26:17,416 - __main__ - INFO - Запуск main()
2025-01-13 01:26:17,417 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:26:17,418 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:26:17,430 - __main__ - INFO - Подключение middleware
2025-01-13 01:26:17,430 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:26:17,430 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:26:17,430 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:26:18,360 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:26:21,122 - aiogram.event - INFO - Update id=785581893 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:26:21,122 - aiogram.event - ERROR - Cause exception while process update id=785581893 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 12, in ask_ai
    user_chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:28:16,773 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:28:16,773 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:28:17,026 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:28:21,251 - __main__ - INFO - Запуск main()
2025-01-13 01:28:21,252 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:28:21,253 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:28:21,263 - __main__ - INFO - Подключение middleware
2025-01-13 01:28:21,263 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:28:21,264 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:28:21,264 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:28:21,905 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:29:02,491 - aiogram.event - INFO - Update id=785581894 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:29:02,491 - aiogram.event - ERROR - Cause exception while process update id=785581894 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 20, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:29:50,672 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:29:50,673 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:29:50,937 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:29:56,742 - __main__ - INFO - Запуск main()
2025-01-13 01:29:56,743 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:29:56,744 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:29:56,756 - __main__ - INFO - Подключение middleware
2025-01-13 01:29:56,756 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:29:56,756 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:29:56,757 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:29:58,132 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:29:58,562 - aiogram.event - INFO - Update id=785581895 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:29:58,562 - aiogram.event - ERROR - Cause exception while process update id=785581895 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 20, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:30:39,561 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:30:39,562 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:30:39,818 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:30:43,843 - __main__ - INFO - Запуск main()
2025-01-13 01:30:43,844 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:30:43,845 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:30:43,855 - __main__ - INFO - Подключение middleware
2025-01-13 01:30:43,855 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:30:43,856 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:30:43,856 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:30:44,486 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:30:46,193 - aiogram.event - INFO - Update id=785581896 is not handled. Duration 16 ms by bot id=7987337779
2025-01-13 01:30:46,193 - aiogram.event - ERROR - Cause exception while process update id=785581896 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 20, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:31:23,471 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:31:23,472 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:31:23,734 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:31:27,746 - __main__ - INFO - Запуск main()
2025-01-13 01:31:27,747 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:31:27,748 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:31:27,760 - __main__ - INFO - Подключение middleware
2025-01-13 01:31:27,760 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:31:27,760 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:31:27,760 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:31:28,683 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:31:29,670 - aiogram.event - INFO - Update id=785581897 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:31:29,671 - aiogram.event - ERROR - Cause exception while process update id=785581897 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 20, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:31:40,789 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:31:40,789 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:31:41,048 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:31:44,875 - __main__ - INFO - Запуск main()
2025-01-13 01:31:44,876 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:31:44,877 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:31:44,887 - __main__ - INFO - Подключение middleware
2025-01-13 01:31:44,887 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:31:44,887 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:31:44,888 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:31:45,528 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:31:46,413 - aiogram.event - INFO - Update id=785581898 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:31:46,413 - aiogram.event - ERROR - Cause exception while process update id=785581898 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 19, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:32:32,071 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:32:32,072 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:32:32,335 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:32:36,331 - __main__ - INFO - Запуск main()
2025-01-13 01:32:36,332 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:32:36,332 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:32:36,343 - __main__ - INFO - Подключение middleware
2025-01-13 01:32:36,343 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:32:36,343 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:32:36,343 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:32:36,978 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:32:45,089 - aiogram.event - INFO - Update id=785581899 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:32:45,090 - aiogram.event - ERROR - Cause exception while process update id=785581899 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 19, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 45, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:33:01,152 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:33:01,152 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:33:01,416 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:33:05,267 - __main__ - INFO - Запуск main()
2025-01-13 01:33:05,268 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:33:05,269 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:33:05,279 - __main__ - INFO - Подключение middleware
2025-01-13 01:33:05,279 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:33:05,279 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:33:05,280 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:33:05,956 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:33:06,738 - aiogram.event - INFO - Update id=785581900 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 01:33:06,738 - aiogram.event - ERROR - Cause exception while process update id=785581900 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 19, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 44, in get_user_chain
    get_session_history=memory.get_history  # Здесь указываем метод для получения истории сессии
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'ConversationBufferMemory' object has no attribute 'get_history'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:37:35,778 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:37:35,801 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:37:36,063 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:37:46,933 - __main__ - INFO - Запуск main()
2025-01-13 01:37:46,934 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:37:46,935 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:37:46,946 - __main__ - INFO - Подключение middleware
2025-01-13 01:37:46,946 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:37:46,946 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:37:46,946 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:37:47,898 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:37:49,012 - aiogram.event - INFO - Update id=785581901 is not handled. Duration 61 ms by bot id=7987337779
2025-01-13 01:37:49,012 - aiogram.event - ERROR - Cause exception while process update id=785581901 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 19, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\utils\ai_assistant.py", line 41, in get_user_chain
    return RunnableWithMessageHistory(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\history.py", line 356, in __init__
    super().__init__(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5275, in __init__
    super().__init__(  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for RunnableWithMessageHistory
get_session_history
  Input should be callable [type=callable_type, input_value=ConversationBufferMemory(...ageHistory(messages=[])), input_type=ConversationBufferMemory]
    For further information visit https://errors.pydantic.dev/2.10/v/callable_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:38:41,173 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:38:41,173 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:38:41,429 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:38:45,608 - __main__ - INFO - Запуск main()
2025-01-13 01:38:45,609 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:38:45,610 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:38:45,664 - __main__ - INFO - Подключение middleware
2025-01-13 01:38:45,665 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:38:45,665 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:38:45,665 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:38:46,605 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:38:47,948 - aiogram.event - INFO - Update id=785581902 is not handled. Duration 110 ms by bot id=7987337779
2025-01-13 01:38:47,948 - aiogram.event - ERROR - Cause exception while process update id=785581902 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    response = chain.invoke(input=user_input)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3020, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4711, in invoke
    return self._call_with_config(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1925, in _call_with_config
    context.run(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4565, in _invoke
    output = call_func_with_variable_args(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\history.py", line 524, in _enter_history
    messages = hist.messages.copy()
AttributeError: 'str' object has no attribute 'messages'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:39:18,689 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:39:18,690 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:39:18,953 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:39:23,048 - __main__ - INFO - Запуск main()
2025-01-13 01:39:23,049 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:39:23,050 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:39:23,060 - __main__ - INFO - Подключение middleware
2025-01-13 01:39:23,060 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:39:23,061 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:39:23,061 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:39:23,708 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:39:25,786 - aiogram.event - INFO - Update id=785581903 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:39:25,786 - aiogram.event - ERROR - Cause exception while process update id=785581903 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 21, in ai_assistant
    response = chain.invoke(input=user_input)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3020, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4711, in invoke
    return self._call_with_config(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1925, in _call_with_config
    context.run(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4565, in _invoke
    output = call_func_with_variable_args(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\history.py", line 524, in _enter_history
    messages = hist.messages.copy()
AttributeError: 'str' object has no attribute 'messages'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:39:58,680 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:39:58,681 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:39:58,934 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:40:03,248 - __main__ - INFO - Запуск main()
2025-01-13 01:40:03,249 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:40:03,249 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:40:03,262 - __main__ - INFO - Подключение middleware
2025-01-13 01:40:03,262 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:40:03,262 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:40:03,262 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:40:03,955 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:40:06,414 - aiogram.event - INFO - Update id=785581904 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:40:06,414 - aiogram.event - ERROR - Cause exception while process update id=785581904 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 21, in ai_assistant
    response = chain.invoke({"input": user_input})
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 3020, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5352, in invoke
    return self.bound.invoke(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4711, in invoke
    return self._call_with_config(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 1925, in _call_with_config
    context.run(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 4565, in _invoke
    output = call_func_with_variable_args(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\config.py", line 396, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\history.py", line 524, in _enter_history
    messages = hist.messages.copy()
AttributeError: 'str' object has no attribute 'messages'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:40:42,754 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:40:42,755 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:40:43,019 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:40:47,846 - __main__ - INFO - Запуск main()
2025-01-13 01:40:47,847 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:40:47,848 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:40:47,858 - __main__ - INFO - Подключение middleware
2025-01-13 01:40:47,858 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:40:47,859 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:40:47,859 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:40:48,596 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:40:49,994 - aiogram.event - INFO - Update id=785581905 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 01:40:49,994 - aiogram.event - ERROR - Cause exception while process update id=785581905 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 29, in ai_assistant
    await message.answer(f"Ответ от ассистента: {response}")
UnboundLocalError: local variable 'response' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:52:56,965 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:52:57,803 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:52:59,810 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:54:27,811 - __main__ - INFO - Запуск main()
2025-01-13 01:54:28,157 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:54:28,318 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:54:28,342 - __main__ - INFO - Подключение middleware
2025-01-13 01:54:28,342 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:54:28,342 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:54:28,344 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:54:31,317 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:54:57,671 - aiogram.event - INFO - Update id=785581906 is not handled. Duration 21843 ms by bot id=7987337779
2025-01-13 01:54:57,671 - aiogram.event - ERROR - Cause exception while process update id=785581906 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 29, in ai_assistant
    await message.answer(f"Ответ от ассистента: {response}")
UnboundLocalError: local variable 'response' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:55:22,624 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:55:22,624 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:55:22,888 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:55:37,612 - __main__ - INFO - Запуск main()
2025-01-13 01:55:37,613 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:55:37,614 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:55:37,625 - __main__ - INFO - Подключение middleware
2025-01-13 01:55:37,625 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:55:37,625 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:55:37,625 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:55:38,295 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:57:58,596 - aiogram.event - INFO - Update id=785581907 is not handled. Duration 21500 ms by bot id=7987337779
2025-01-13 01:57:58,596 - aiogram.event - ERROR - Cause exception while process update id=785581907 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 29, in ai_assistant
    await message.answer(f"Ответ от ассистента: {response}")
UnboundLocalError: local variable 'response' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 01:58:03,408 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:58:03,408 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 01:58:03,669 - __main__ - INFO - Закрытие сессии бота
2025-01-13 01:58:52,520 - __main__ - INFO - Запуск main()
2025-01-13 01:58:52,802 - __main__ - INFO - Инициализация базы данных
2025-01-13 01:58:53,089 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 01:58:53,116 - __main__ - INFO - Подключение middleware
2025-01-13 01:58:53,116 - __main__ - INFO - Регистрация хендлеров
2025-01-13 01:58:53,116 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 01:58:53,146 - aiogram.dispatcher - INFO - Start polling
2025-01-13 01:58:54,661 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 01:59:33,304 - aiogram.event - INFO - Update id=785581908 is not handled. Duration 21280 ms by bot id=7987337779
2025-01-13 01:59:33,304 - aiogram.event - ERROR - Cause exception while process update id=785581908 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 72, in map_httpcore_exceptions
    yield
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10060] Попытка установить соединение была безуспешной, т.к. от другого компьютера за требуемое время не получен нужный отклик, или было разорвано уже установленное соединение из-за неверного отклика уже подключенного компьютера

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 21, in ai_assistant
    response = chain.invoke(input=user_input)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\base.py", line 170, in invoke
    raise e
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\base.py", line 160, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\llm.py", line 126, in _call
    response = self.generate([inputs], run_manager=run_manager)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\llm.py", line 138, in generate
    return self.llm.generate_prompt(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 786, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 643, in generate
    raise e
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 633, in generate
    self._generate_with_cache(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 851, in _generate_with_cache
    result = self._generate(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_gigachat\chat_models\gigachat.py", line 432, in _generate
    response = self._client.chat(payload)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 295, in chat
    return self._decorator(lambda: post_chat.sync(self._client, chat=chat, access_token=self.token))
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 253, in _decorator
    self._update_token()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 224, in _update_token
    self._access_token = post_auth.sync(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\api\post_auth.py", line 52, in sync
    response = client.request(**kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10060] Попытка установить соединение была безуспешной, т.к. от другого компьютера за требуемое время не получен нужный отклик, или было разорвано уже установленное соединение из-за неверного отклика уже подключенного компьютера

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:13:04,381 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:13:04,416 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:13:04,672 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:13:17,798 - __main__ - INFO - Запуск main()
2025-01-13 02:13:17,799 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:13:17,800 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:13:17,811 - __main__ - INFO - Подключение middleware
2025-01-13 02:13:17,811 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:13:17,811 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:13:17,811 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:13:18,976 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:13:29,161 - aiogram.event - INFO - Update id=785581909 is not handled. Duration 78 ms by bot id=7987337779
2025-01-13 02:13:29,161 - aiogram.event - ERROR - Cause exception while process update id=785581909 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:13:51,974 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:13:51,974 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:13:52,235 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:13:57,398 - __main__ - INFO - Запуск main()
2025-01-13 02:13:57,399 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:13:57,400 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:13:57,411 - __main__ - INFO - Подключение middleware
2025-01-13 02:13:57,411 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:13:57,411 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:13:57,411 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:13:58,079 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:14:00,378 - aiogram.event - INFO - Update id=785581910 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 02:14:00,379 - aiogram.event - ERROR - Cause exception while process update id=785581910 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:14:24,398 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:14:24,398 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:14:24,663 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:14:29,442 - __main__ - INFO - Запуск main()
2025-01-13 02:14:29,443 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:14:29,444 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:14:29,454 - __main__ - INFO - Подключение middleware
2025-01-13 02:14:29,454 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:14:29,454 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:14:29,455 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:14:30,110 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:14:30,356 - aiogram.event - INFO - Update id=785581911 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 02:14:30,356 - aiogram.event - ERROR - Cause exception while process update id=785581911 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 32, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:14:41,541 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:14:41,541 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:14:41,797 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:14:54,520 - __main__ - INFO - Запуск main()
2025-01-13 02:14:54,520 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:14:54,521 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:14:54,531 - __main__ - INFO - Подключение middleware
2025-01-13 02:14:54,531 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:14:54,531 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:14:54,531 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:14:55,410 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:15:16,404 - aiogram.event - INFO - Update id=785581912 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 02:15:16,404 - aiogram.event - ERROR - Cause exception while process update id=785581912 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:15:26,390 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:15:26,390 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:15:26,633 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:15:34,651 - __main__ - INFO - Запуск main()
2025-01-13 02:15:34,651 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:15:34,657 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:15:34,668 - __main__ - INFO - Подключение middleware
2025-01-13 02:15:34,668 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:15:34,668 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:15:34,668 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:15:35,324 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:15:38,256 - aiogram.event - INFO - Update id=785581913 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 02:15:38,256 - aiogram.event - ERROR - Cause exception while process update id=785581913 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:16:04,983 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:16:04,983 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:16:05,240 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:16:09,363 - __main__ - INFO - Запуск main()
2025-01-13 02:16:09,364 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:16:09,365 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:16:09,375 - __main__ - INFO - Подключение middleware
2025-01-13 02:16:09,375 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:16:09,375 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:16:09,375 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:16:10,315 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:16:11,528 - aiogram.event - INFO - Update id=785581914 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 02:16:11,528 - aiogram.event - ERROR - Cause exception while process update id=785581914 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:16:24,956 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:16:24,957 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:16:25,210 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:16:29,276 - __main__ - INFO - Запуск main()
2025-01-13 02:16:29,277 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:16:29,278 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:16:29,288 - __main__ - INFO - Подключение middleware
2025-01-13 02:16:29,288 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:16:29,288 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:16:29,288 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:16:30,252 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:16:59,054 - aiogram.event - INFO - Update id=785581915 is not handled. Duration 15 ms by bot id=7987337779
2025-01-13 02:16:59,054 - aiogram.event - ERROR - Cause exception while process update id=785581915 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 22, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 33, in get_user_chain
    llm_chain = LLMChain(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\_api\deprecation.py", line 216, in warn_if_direct_instance
    return wrapped(self, *args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for LLMChain
memory
  Input should be a valid dictionary or instance of BaseMemory [type=model_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:18:51,364 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:18:51,396 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:18:51,663 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:19:10,315 - __main__ - INFO - Запуск main()
2025-01-13 02:19:10,317 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:19:10,318 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:19:10,330 - __main__ - INFO - Подключение middleware
2025-01-13 02:19:10,330 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:19:10,330 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:19:10,331 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:19:10,987 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:19:13,320 - aiogram.event - INFO - Update id=785581916 is not handled. Duration 47 ms by bot id=7987337779
2025-01-13 02:19:13,320 - aiogram.event - ERROR - Cause exception while process update id=785581916 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 43, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 63, in get_user_chain
    return llm_chain
UnboundLocalError: local variable 'llm_chain' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:19:37,400 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:19:37,400 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:19:37,654 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:19:41,895 - __main__ - INFO - Запуск main()
2025-01-13 02:19:41,896 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:19:41,897 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:19:41,907 - __main__ - INFO - Подключение middleware
2025-01-13 02:19:41,907 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:19:41,907 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:19:41,908 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:19:42,613 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:20:16,109 - aiogram.event - INFO - Update id=785581917 is not handled. Duration 21094 ms by bot id=7987337779
2025-01-13 02:20:16,109 - aiogram.event - ERROR - Cause exception while process update id=785581917 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 72, in map_httpcore_exceptions
    yield
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 256, in handle_request
    raise exc from None
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 101, in handle_request
    raise exc
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_sync\connection.py", line 124, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_backends\sync.py", line 215, in connect_tcp
    sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [WinError 10060] Попытка установить соединение была безуспешной, т.к. от другого компьютера за требуемое время не получен нужный отклик, или было разорвано уже установленное соединение из-за неверного отклика уже подключенного компьютера

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 44, in ai_assistant
    response = chain.invoke({"input": user_input})
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\base.py", line 170, in invoke
    raise e
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\base.py", line 160, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\llm.py", line 126, in _call
    response = self.generate([inputs], run_manager=run_manager)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain\chains\llm.py", line 138, in generate
    return self.llm.generate_prompt(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 786, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 643, in generate
    raise e
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 633, in generate
    self._generate_with_cache(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\language_models\chat_models.py", line 851, in _generate_with_cache
    result = self._generate(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_gigachat\chat_models\gigachat.py", line 432, in _generate
    response = self._client.chat(payload)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 295, in chat
    return self._decorator(lambda: post_chat.sync(self._client, chat=chat, access_token=self.token))
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 253, in _decorator
    self._update_token()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\client.py", line 224, in _update_token
    self._access_token = post_auth.sync(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\gigachat\api\post_auth.py", line 52, in sync
    response = client.request(**kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 926, in send
    response = self._send_handling_auth(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\httpx\_transports\default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [WinError 10060] Попытка установить соединение была безуспешной, т.к. от другого компьютера за требуемое время не получен нужный отклик, или было разорвано уже установленное соединение из-за неверного отклика уже подключенного компьютера

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:20:33,968 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:20:33,969 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:20:34,228 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:20:38,169 - __main__ - INFO - Запуск main()
2025-01-13 02:20:38,170 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:20:38,171 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:20:38,184 - __main__ - INFO - Подключение middleware
2025-01-13 02:20:38,184 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:20:38,184 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:20:38,184 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:20:38,829 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:21:17,575 - aiogram.event - INFO - Update id=785581918 is not handled. Duration 21078 ms by bot id=7987337779
2025-01-13 02:21:17,575 - aiogram.event - ERROR - Cause exception while process update id=785581918 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 48, in ai_assistant
    await message.answer(f"Ответ от ассистента: {response}")
UnboundLocalError: local variable 'response' referenced before assignment

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:24:50,701 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2025-01-13 02:24:50,807 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:25:02,974 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-13 02:26:28,357 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:26:28,357 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:26:28,618 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:26:41,506 - __main__ - INFO - Запуск main()
2025-01-13 02:26:41,507 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:26:41,525 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:26:41,536 - __main__ - INFO - Подключение middleware
2025-01-13 02:26:41,536 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:26:41,536 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:26:41,536 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:26:41,731 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:26:45,204 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-13 02:26:46,060 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:26:47,010 - aiogram.event - INFO - Update id=785581919 is handled. Duration 2093 ms by bot id=7987337779
2025-01-13 02:27:02,938 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:27:03,005 - aiogram.event - INFO - Update id=785581920 is handled. Duration 827 ms by bot id=7987337779
2025-01-13 02:27:12,960 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:27:13,033 - aiogram.event - INFO - Update id=785581921 is handled. Duration 938 ms by bot id=7987337779
2025-01-13 02:28:51,769 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-13 02:28:51,769 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:29:03,399 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-13 02:37:43,506 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2025-01-13 02:37:43,508 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:37:54,681 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-13 02:38:34,075 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:38:34,075 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:38:34,340 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:38:45,414 - __main__ - INFO - Запуск main()
2025-01-13 02:38:45,415 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:38:45,416 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:38:45,427 - __main__ - INFO - Подключение middleware
2025-01-13 02:38:45,427 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:38:45,427 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:38:45,427 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:38:45,610 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:38:54,143 - aiogram.event - INFO - Update id=785581922 is not handled. Duration 61 ms by bot id=7987337779
2025-01-13 02:38:54,143 - aiogram.event - ERROR - Cause exception while process update id=785581922 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 38, in ai_assistant
    chain = get_user_chain(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 62, in get_user_chain
    chain = RunnableWithMessageHistory(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\history.py", line 356, in __init__
    super().__init__(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\runnables\base.py", line 5275, in __init__
    super().__init__(  # type: ignore[call-arg]
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\langchain_core\load\serializable.py", line 125, in __init__
    super().__init__(*args, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for RunnableWithMessageHistory
get_session_history
  Input should be callable [type=callable_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.10/v/callable_type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 02:40:13,674 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-13 02:40:13,674 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:40:25,310 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-13 02:45:59,315 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:45:59,315 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:45:59,579 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:46:41,222 - __main__ - INFO - Запуск main()
2025-01-13 02:46:41,223 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:46:41,275 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:46:41,286 - __main__ - INFO - Подключение middleware
2025-01-13 02:46:41,286 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:46:41,287 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:46:41,287 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:46:45,581 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:47:18,785 - aiogram.event - INFO - Update id=785581923 is handled. Duration 22516 ms by bot id=7987337779
2025-01-13 02:47:45,040 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:47:45,114 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:47:45,469 - __main__ - INFO - Закрытие сессии бота
2025-01-13 02:48:48,017 - __main__ - INFO - Запуск main()
2025-01-13 02:48:48,018 - __main__ - INFO - Инициализация базы данных
2025-01-13 02:48:48,074 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 02:48:48,084 - __main__ - INFO - Подключение middleware
2025-01-13 02:48:48,085 - __main__ - INFO - Регистрация хендлеров
2025-01-13 02:48:48,085 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 02:48:48,085 - aiogram.dispatcher - INFO - Start polling
2025-01-13 02:48:48,239 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:48:58,244 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-13 02:48:59,107 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:48:59,495 - aiogram.event - INFO - Update id=785581924 is handled. Duration 1437 ms by bot id=7987337779
2025-01-13 02:49:24,174 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:49:24,250 - aiogram.event - INFO - Update id=785581925 is handled. Duration 796 ms by bot id=7987337779
2025-01-13 02:49:32,980 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:49:33,053 - aiogram.event - INFO - Update id=785581926 is handled. Duration 922 ms by bot id=7987337779
2025-01-13 02:50:51,113 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 02:50:51,278 - aiogram.event - INFO - Update id=785581927 is handled. Duration 2531 ms by bot id=7987337779
2025-01-13 02:51:38,173 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 121] Превышен таймаут семафора
2025-01-13 02:51:38,173 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:51:49,905 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-13 02:59:07,492 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2025-01-13 02:59:07,492 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-13 02:59:18,675 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 02:59:18,675 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 02:59:18,937 - __main__ - INFO - Закрытие сессии бота
2025-01-13 03:02:19,064 - __main__ - INFO - Запуск main()
2025-01-13 03:02:19,065 - __main__ - INFO - Инициализация базы данных
2025-01-13 03:02:19,087 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 03:02:19,097 - __main__ - INFO - Подключение middleware
2025-01-13 03:02:19,097 - __main__ - INFO - Регистрация хендлеров
2025-01-13 03:02:19,097 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 03:02:19,098 - aiogram.dispatcher - INFO - Start polling
2025-01-13 03:02:19,313 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:02:19,395 - aiogram.event - INFO - Update id=785581929 is not handled. Duration 16 ms by bot id=7987337779
2025-01-13 03:02:19,395 - aiogram.event - ERROR - Cause exception while process update id=785581929 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 38, in ai_assistant
    chat_history = get_user_history(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 60, in get_user_history
    if user_id not in user_histories:
NameError: name 'user_histories' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 03:02:19,942 - aiogram.event - INFO - Update id=785581928 is handled. Duration 547 ms by bot id=7987337779
2025-01-13 03:02:31,685 - aiogram.event - INFO - Update id=785581930 is not handled. Duration 0 ms by bot id=7987337779
2025-01-13 03:02:31,686 - aiogram.event - ERROR - Cause exception while process update id=785581930 by bot id=7987337779
TypeError: handle_errors() missing 1 required positional argument: 'exception'
Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\bot\middlewares\registration_check.py", line 31, in __call__
    return await handler(event, data)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 38, in ai_assistant
    chat_history = get_user_history(user_id)
  File "D:\Programming\Python\RunnerBot\bot\handlers\chat_ai.py", line 60, in get_user_history
    if user_id not in user_histories:
NameError: name 'user_histories' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 29, in __call__
    response = await self.router.propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
  File "D:\Programming\Python\RunnerBot\.venv\lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
TypeError: handle_errors() missing 1 required positional argument: 'exception'
2025-01-13 03:03:06,561 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 03:03:06,562 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:03:06,816 - __main__ - INFO - Закрытие сессии бота
2025-01-13 03:03:24,707 - __main__ - INFO - Запуск main()
2025-01-13 03:03:24,708 - __main__ - INFO - Инициализация базы данных
2025-01-13 03:03:24,709 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 03:03:24,719 - __main__ - INFO - Подключение middleware
2025-01-13 03:03:24,720 - __main__ - INFO - Регистрация хендлеров
2025-01-13 03:03:24,720 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 03:03:24,720 - aiogram.dispatcher - INFO - Start polling
2025-01-13 03:03:26,249 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:03:52,682 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-13 03:03:53,460 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:03:53,653 - aiogram.event - INFO - Update id=785581931 is handled. Duration 1109 ms by bot id=7987337779
2025-01-13 03:04:09,678 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:04:09,748 - aiogram.event - INFO - Update id=785581932 is handled. Duration 843 ms by bot id=7987337779
2025-01-13 03:04:26,811 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:04:26,884 - aiogram.event - INFO - Update id=785581933 is handled. Duration 983 ms by bot id=7987337779
2025-01-13 03:04:35,992 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:04:36,078 - aiogram.event - INFO - Update id=785581934 is handled. Duration 922 ms by bot id=7987337779
2025-01-13 03:04:51,134 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:04:51,240 - aiogram.event - INFO - Update id=785581935 is handled. Duration 1077 ms by bot id=7987337779
2025-01-13 03:05:05,867 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:05:05,934 - aiogram.event - INFO - Update id=785581936 is handled. Duration 969 ms by bot id=7987337779
2025-01-13 03:05:20,460 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 03:05:20,461 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:05:20,724 - __main__ - INFO - Закрытие сессии бота
2025-01-13 03:05:25,514 - __main__ - INFO - Запуск main()
2025-01-13 03:05:25,515 - __main__ - INFO - Инициализация базы данных
2025-01-13 03:05:25,516 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 03:05:25,527 - __main__ - INFO - Подключение middleware
2025-01-13 03:05:25,527 - __main__ - INFO - Регистрация хендлеров
2025-01-13 03:05:25,527 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 03:05:25,527 - aiogram.dispatcher - INFO - Start polling
2025-01-13 03:05:25,710 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:05:30,002 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-13 03:05:30,740 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:05:30,965 - aiogram.event - INFO - Update id=785581937 is handled. Duration 1061 ms by bot id=7987337779
2025-01-13 03:05:41,359 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:05:41,425 - aiogram.event - INFO - Update id=785581938 is handled. Duration 843 ms by bot id=7987337779
2025-01-13 03:05:55,681 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:05:55,751 - aiogram.event - INFO - Update id=785581939 is handled. Duration 1109 ms by bot id=7987337779
2025-01-13 03:06:14,433 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:06:14,545 - aiogram.event - INFO - Update id=785581940 is handled. Duration 1609 ms by bot id=7987337779
2025-01-13 03:07:26,475 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:07:26,643 - aiogram.event - INFO - Update id=785581941 is handled. Duration 2468 ms by bot id=7987337779
2025-01-13 03:07:50,511 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 03:07:50,511 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:07:50,756 - __main__ - INFO - Закрытие сессии бота
2025-01-13 03:08:51,460 - __main__ - INFO - Запуск main()
2025-01-13 03:08:51,461 - __main__ - INFO - Инициализация базы данных
2025-01-13 03:08:51,462 - __main__ - INFO - Настройка бота и диспетчера
2025-01-13 03:08:51,499 - __main__ - INFO - Подключение middleware
2025-01-13 03:08:51,499 - __main__ - INFO - Регистрация хендлеров
2025-01-13 03:08:51,499 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-13 03:08:51,500 - aiogram.dispatcher - INFO - Start polling
2025-01-13 03:08:51,665 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:09:10,850 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-13 03:09:11,788 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:09:11,991 - aiogram.event - INFO - Update id=785581942 is handled. Duration 1265 ms by bot id=7987337779
2025-01-13 03:09:22,444 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:09:22,524 - aiogram.event - INFO - Update id=785581943 is handled. Duration 1202 ms by bot id=7987337779
2025-01-13 03:09:49,021 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:09:49,092 - aiogram.event - INFO - Update id=785581944 is handled. Duration 1264 ms by bot id=7987337779
2025-01-13 03:10:00,367 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:10:00,432 - aiogram.event - INFO - Update id=785581945 is handled. Duration 1094 ms by bot id=7987337779
2025-01-13 03:10:09,214 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:10:09,294 - aiogram.event - INFO - Update id=785581946 is handled. Duration 1547 ms by bot id=7987337779
2025-01-13 03:10:23,595 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:10:23,781 - aiogram.event - INFO - Update id=785581947 is handled. Duration 1297 ms by bot id=7987337779
2025-01-13 03:10:37,512 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-13 03:10:37,607 - aiogram.event - INFO - Update id=785581948 is handled. Duration 3202 ms by bot id=7987337779
2025-01-13 03:13:43,178 - aiogram.event - INFO - Update id=785581949 is handled. Duration 125 ms by bot id=7987337779
2025-01-13 03:13:48,270 - aiogram.event - INFO - Update id=785581950 is handled. Duration 1577 ms by bot id=7987337779
2025-01-13 03:15:28,772 - aiogram.dispatcher - INFO - Polling stopped
2025-01-13 03:15:28,772 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-13 03:15:29,041 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:26:19,843 - __main__ - INFO - Запуск main()
2025-01-15 01:26:19,956 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:26:20,072 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:26:20,090 - __main__ - INFO - Подключение middleware
2025-01-15 01:26:20,090 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:26:20,091 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:26:20,092 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:26:22,231 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:28:18,242 - aiogram.event - INFO - Update id=785581951 is handled. Duration 22577 ms by bot id=7987337779
2025-01-15 01:32:17,393 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:32:17,393 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:32:17,658 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:32:30,418 - __main__ - INFO - Запуск main()
2025-01-15 01:32:30,418 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:32:30,453 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:32:30,472 - __main__ - INFO - Подключение middleware
2025-01-15 01:32:30,473 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:32:30,473 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:32:30,473 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:32:31,670 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:32:57,378 - aiogram.event - INFO - Update id=785581952 is handled. Duration 21952 ms by bot id=7987337779
2025-01-15 01:34:19,835 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2025-01-15 01:34:19,835 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7987337779)
2025-01-15 01:34:31,075 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 7987337779)
2025-01-15 01:35:06,168 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:35:06,184 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:35:06,446 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:35:19,401 - __main__ - INFO - Запуск main()
2025-01-15 01:35:19,402 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:35:19,495 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:35:19,514 - __main__ - INFO - Подключение middleware
2025-01-15 01:35:19,514 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:35:19,515 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:35:19,515 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:35:19,701 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:35:39,322 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-15 01:35:43,769 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:35:44,015 - aiogram.event - INFO - Update id=785581953 is handled. Duration 4843 ms by bot id=7987337779
2025-01-15 01:37:54,225 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:37:54,226 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:37:54,487 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:38:01,432 - __main__ - INFO - Запуск main()
2025-01-15 01:38:01,433 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:38:01,434 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:38:01,453 - __main__ - INFO - Подключение middleware
2025-01-15 01:38:01,454 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:38:01,454 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:38:01,454 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:38:01,653 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:38:11,334 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-15 01:38:13,633 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:38:13,903 - aiogram.event - INFO - Update id=785581954 is handled. Duration 2734 ms by bot id=7987337779
2025-01-15 01:38:31,331 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:38:31,461 - aiogram.event - INFO - Update id=785581955 is handled. Duration 1358 ms by bot id=7987337779
2025-01-15 01:38:56,349 - httpx - INFO - HTTP Request: POST https://ngw.devices.sberbank.ru:9443/api/v2/oauth "HTTP/1.1 200 OK"
2025-01-15 01:38:57,131 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:38:57,203 - aiogram.event - INFO - Update id=785581956 is handled. Duration 938 ms by bot id=7987337779
2025-01-15 01:39:13,277 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:39:13,359 - aiogram.event - INFO - Update id=785581957 is handled. Duration 2655 ms by bot id=7987337779
2025-01-15 01:39:25,565 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:39:25,644 - aiogram.event - INFO - Update id=785581958 is handled. Duration 1202 ms by bot id=7987337779
2025-01-15 01:39:43,944 - httpx - INFO - HTTP Request: POST https://gigachat.devices.sberbank.ru/api/v1/chat/completions "HTTP/1.1 200 OK"
2025-01-15 01:39:44,020 - aiogram.event - INFO - Update id=785581959 is handled. Duration 2905 ms by bot id=7987337779
2025-01-15 01:39:54,393 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:39:54,393 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:39:54,634 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:49:15,448 - __main__ - INFO - Запуск main()
2025-01-15 01:49:15,449 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:49:15,451 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:49:15,470 - __main__ - INFO - Подключение middleware
2025-01-15 01:49:15,470 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:49:15,470 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:49:15,470 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:49:20,541 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:49:40,780 - aiogram.event - INFO - Update id=785581960 is handled. Duration 2047 ms by bot id=7987337779
2025-01-15 01:51:31,466 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:51:31,466 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:51:31,721 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:51:39,948 - __main__ - INFO - Запуск main()
2025-01-15 01:51:39,950 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:51:39,952 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:51:39,970 - __main__ - INFO - Подключение middleware
2025-01-15 01:51:39,970 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:51:39,970 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:51:39,970 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:51:40,913 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:52:04,578 - aiogram.event - INFO - Update id=785581961 is handled. Duration 1344 ms by bot id=7987337779
2025-01-15 01:52:14,374 - aiogram.event - INFO - Update id=785581962 is handled. Duration 484 ms by bot id=7987337779
2025-01-15 01:52:16,525 - aiogram.event - INFO - Update id=785581963 is handled. Duration 313 ms by bot id=7987337779
2025-01-15 01:52:21,885 - aiogram.event - INFO - Update id=785581964 is handled. Duration 297 ms by bot id=7987337779
2025-01-15 01:52:23,837 - aiogram.event - INFO - Update id=785581965 is handled. Duration 250 ms by bot id=7987337779
2025-01-15 01:52:48,508 - aiogram.event - INFO - Update id=785581966 is handled. Duration 250 ms by bot id=7987337779
2025-01-15 01:54:00,641 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:54:00,641 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 01:54:00,902 - __main__ - INFO - Закрытие сессии бота
2025-01-15 01:54:07,793 - __main__ - INFO - Запуск main()
2025-01-15 01:54:07,794 - __main__ - INFO - Инициализация базы данных
2025-01-15 01:54:07,795 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 01:54:07,814 - __main__ - INFO - Подключение middleware
2025-01-15 01:54:07,815 - __main__ - INFO - Регистрация хендлеров
2025-01-15 01:54:07,815 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 01:54:07,815 - aiogram.dispatcher - INFO - Start polling
2025-01-15 01:54:09,482 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 01:54:10,469 - aiogram.event - INFO - Update id=785581967 is handled. Duration 733 ms by bot id=7987337779
2025-01-15 01:54:14,048 - aiogram.event - INFO - Update id=785581968 is handled. Duration 515 ms by bot id=7987337779
2025-01-15 01:54:32,291 - aiogram.event - INFO - Update id=785581969 is handled. Duration 234 ms by bot id=7987337779
2025-01-15 01:55:02,868 - aiogram.event - INFO - Update id=785581970 is handled. Duration 22234 ms by bot id=7987337779
2025-01-15 02:02:39,132 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 02:02:39,133 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 02:02:39,392 - __main__ - INFO - Закрытие сессии бота
2025-01-15 02:02:46,266 - __main__ - INFO - Запуск main()
2025-01-15 02:02:46,268 - __main__ - INFO - Инициализация базы данных
2025-01-15 02:02:46,269 - __main__ - INFO - Настройка бота и диспетчера
2025-01-15 02:02:46,288 - __main__ - INFO - Подключение middleware
2025-01-15 02:02:46,288 - __main__ - INFO - Регистрация хендлеров
2025-01-15 02:02:46,288 - __main__ - INFO - Бот запущен! Начало polling...
2025-01-15 02:02:46,288 - aiogram.dispatcher - INFO - Start polling
2025-01-15 02:02:47,229 - aiogram.dispatcher - INFO - Run polling for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 02:02:54,331 - aiogram.event - INFO - Update id=785581971 is handled. Duration 656 ms by bot id=7987337779
2025-01-15 02:03:00,956 - aiogram.event - INFO - Update id=785581972 is handled. Duration 344 ms by bot id=7987337779
2025-01-15 02:03:08,343 - aiogram.event - INFO - Update id=785581973 is handled. Duration 218 ms by bot id=7987337779
2025-01-15 02:03:11,344 - aiogram.event - INFO - Update id=785581974 is handled. Duration 250 ms by bot id=7987337779
2025-01-15 02:03:18,284 - aiogram.event - INFO - Update id=785581975 is handled. Duration 547 ms by bot id=7987337779
2025-01-15 02:03:22,844 - aiogram.event - INFO - Update id=785581976 is handled. Duration 233 ms by bot id=7987337779
2025-01-15 02:03:27,904 - aiogram.event - INFO - Update id=785581977 is handled. Duration 234 ms by bot id=7987337779
2025-01-15 02:03:47,600 - aiogram.dispatcher - INFO - Polling stopped for bot @airunnerbot id=7987337779 - 'RunnerBot'
2025-01-15 02:03:47,600 - aiogram.dispatcher - INFO - Polling stopped
2025-01-15 02:03:47,863 - __main__ - INFO - Закрытие сессии бота
